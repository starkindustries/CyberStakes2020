# CyberStakes 2020

Write-ups for the challenges in All-Army CyberStakes 4 (AACS4).

## Binary Exploitation

**Total Problems:** 11

**Total Points:** 2475

| Challenge Name               | Points  | Write-up |
| -----------------------------|:-------:|:--------:|
| [Binary Exploitation 101](./BinaryExploitation/BinaryExploitation101) | 50 | ✔️ |
| [Your Cup Overfloweth](./BinaryExploitation/YourCupOverfloweth) | 75 |  |
| [Hacker, Scan Thyself](./BinaryExploitation/HackerScanThyself) | 100 |  |
| [Serial Killer](./BinaryExploitation/SerialKiller) | 100 | ✔️ |
| [Stack Check Fail Fail](./BinaryExploitation/StackCheckFailFail) | 150 | ✔️ |
| [An Interesting Structure](./BinaryExploitation/AnInterestingStructure) | 250 | ✔️ |
| [Do you C what I C](./BinaryExploitation/DoYouCWhatIC) | 250 | ✔️ |
| [Who Does This Belong To](./BinaryExploitation/WhoDoesThisBelongTo) | 250 | ✔️ |
| [Party ROPin in the House](./BinaryExploitation/PartyROPinInTheHouse) | 300 | ✔️|
| [Speed Racer](./BinaryExploitation/SpeedRacer) | 450 | ✔️ |
| [Look At The Totem](./BinaryExploitation/LookAtTheTotem) | 500 | ✔️ |

## Cryptography

**Total Problems:** 7

**Total Points:** 1040

| Challenge Name               | Points  | Write-up |
| -----------------------------|:-------:|:--------:|
| [Rotate Me](./Cryptography/RotateMe) | 5 | ✔️ |
| [Really Senseless Admins](./Cryptography/ReallySenselessAdmins) | 35 | ✔️ |
| [Over Time: Paid](./Cryptography/OverTimePaid) | 50 | ✔️ |
| [Speak Plainly](./Cryptography/SpeakPlainly) | 150 | ✔️ |
| [Headpiece Silver](./Cryptography/HeadpieceSilver) | 200 | |
| [We're Related](./Cryptography/WereRelated) | 250 | ✔️ |
| [Pigeon Holes](./Cryptography/PigeonHoles) | 350 | ✔️ |

## Forensics

**Total Problems:** 13

**Total Points:** 1905

| Challenge Name               | Points  | Write-up |
| -----------------------------|:-------:|:--------:|
| [Filing Extension](./Forensics/FilingExtension) | 10 | ✔️ |
| [Bootcamp](./Forensics/Bootcamp) | 20 | ✔️ |
| [Controlled Access](./Forensics/ControlledAccess) | 50 | ✔️ |
| [Not So Meta](./Forensics/NotSoMeta) | 50 | ✔️ |
| [Boot Master](./Forensics/BootMaster) | 75 | ✔️ |
| [Boot Riddle](./Forensics/BootRiddle) | 100 | ✔️ |
| [That's More Than Enough](./Forensics/ThatsMoreThanEnough) | 100 | ✔️ |
| [Turtles All the Way Down](./Forensics/TurtlesAllTheWayDown) | 100 | ✔️ |
| [Boot Racer](./Forensics/BootRacer) | 150 | ✔️ |
| [Sharing is Caring](./Forensics/SharingIsCaring) | 250 | ✔️ |
| [Drill to the Center](./Forensics/DrillToTheCenter) | 300 | ✔️ |
| [Needle in the Haystack](./Forensics/NeedleInTheHaystack) | 300 | |
| [Kids on the Block](./Forensics/KidsOnTheBlock) | 400 | ✔️ |

## Miscellaneous

**Total Problems:** 12

**Total Points:** 1830

| Challenge Name               | Points  | Write-up |
| -----------------------------|:-------:|:--------:|
| [All Your Base Are Belong to Us](./Miscellaneous/AllYourBase) | 50 | ✔️ |
| [Move ZIG](./Miscellaneous/MoveZIG) | 75 | ✔️ |
| [Proxy List](./Miscellaneous/ProxyList) | 100 | ✔️ |
| [Can You Look This Over?](./Miscellaneous/CanYouLookThisOver) | 150 | ✔️ |
| [Recovery And IDentification](./Miscellaneous/RecoveryAndIDentification) | 150 | ✔️ |
| [I SEe You](./Miscellaneous/ISEeYou) | 200 | ✔️ |
| [Partition Twice, Recover Once](./Miscellaneous/PartitionTwiceRecoverOnce) | 250 | ✔️ |
| [PassThis](./Miscellaneous/PassThis) | 250 | ➖ |
| [Assembly Voyageur](./Miscellaneous/AssemblyVoyageur) | 300 | ✔️ |
| [UNO Reverse Card](./Miscellaneous/UNOReverseCard) | 300 | ✔️ |

## Reverse Engineering

**Total Problems:** 11

**Total Points:** 2125

| Challenge Name               | Points  | Write-up |
| -----------------------------|:-------:|:--------:|
| [Reverse Engineering 101](./ReverseEngineering/ReverseEngineering101) | 25 | ✔️ |
| [Lockbox](./ReverseEngineering/Lockbox) | 50 | ✔️ |
| [National Dex #65](./ReverseEngineering/NationalDex65) | 100 | ✔️ |
| [Read it and Weep](./ReverseEngineering/ReadItAndWeep) | 100 | ✔️ |
| [What's the Difference?](./ReverseEngineering/WhatsTheDifference) | 100 | ✔️ |
| [Library Card](./ReverseEngineering/LibraryCard) | 150 | ✔️ |
| [Say What?](./ReverseEngineering/SayWhat) | 200 | ✔️ |
| [C&C Music Factory](./ReverseEngineering/CandCMusicFactory) | 300 | ✔️ |
| [CLRly just a crack-me](./ReverseEngineering/CLRlyJustACrackMe) | 300 | |
| [Are You Maching Me](./ReverseEngineering/AreYouMachingMe) | 350 | |
| [Into the Metaverse](./ReverseEngineering/IntoTheMetaverse) | 450 | ✔️ |

## Web Security]

**Total Problems:** 13

**Total Points:** 1960

| Challenge Name               | Points  | Write-up |
| -----------------------------|:-------:|:--------:|
| [Out of Site](./WebSecurity/OutOfSite) | 5 | ✔️ |
| [More Out of Site](./WebSecurity/MoreOutOfSite) | 10 | ✔️ |
| [Most Out of Site](./WebSecurity/MostOutOfSite) | 20 | ✔️ |
| [Let me INNNNNN](./WebSecurity/LetMeInnnnnn) | 40 | ✔️ |
| [No Escape](./WebSecurity/NoEscape) | 60 | ✔️ |
| [DENIED](./WebSecurity/DENIED) | 75 | ✔️ |
| [Blame it on the Temp](./WebSecurity/BlameItOnTheTemp) | 150 | ✔️|
| [The SQL Always Sucks](./WebSecurity/TheSQLAlwaysSucks) | 150 | ✔️ |
| [Cookie Monster](./WebSecurity/CookieMonster) | 200 | ✔️ |
| [I Have Caught You Now](./WebSecurity/IHaveCaughtYouNow) | 250 | ✔️ |
| [Extremely Malicious Language](./WebSecurity/ExtremelyMaliciousLanguage) | 300 | ✔️ |
| [Who Is That In That Mirror](./WebSecurity/WhoIsThatInThatMirror) | 300 | ✔️ |
| [FirstFail](./WebSecurity/FirstFail) | 400 | ✔️ |

# =============================================

## Not So Meta - Points: 50
### Prompt
Look, it's the flag! Oh wait...it looks like we need to take a closer look... not_so_meta.jpg

### Hints
How do images keep contextual information when they're created? (e.g., GPS data, creation timestamp, etc.)
How do you encode binary data into common ASCII characters?

### Notes
Starting off with hexdump, we can see that there is some exif data stored in the jpg file. 
hexdump -C not_so_meta.jpg > not_so_meta_hex.txt

To view just the ascii bytes, we can use the 'strings' command. 
strings -n 64 not_so_meta.jpg > not_so_meta.txt

This shows a few lines of text including:
<xmp:ItsTheFlag>QUNJezhhM2E0OWJjZWUxM2MzZGNlYzE4MGQzNDgxZX0=</xmp:ItsTheFlag>

Convert that base64 string to ascii to get the flag.

## No Escape - Points: 60
### Solve
Since in-person events are currently banned, some magician we've never heard of is trying to sell us on the idea of a "digital" magic show where the magician logs in using an impossible password. For added assurances, one lucky audience member is able to login and see the hash of the password as proof the password is impossible. We're willing to bet the secret to this magic trick is not all that complicated. http://challenge.acictf.com:10952

### Hints
Inexperienced web application developers don't always esacpe/sanitize user inputs in there database query strings. This frequently allows SQL injection attacks that result in unintended behavior.
The developer was pretty new, so just causing the query to error out may get you more information for the exploit. What happens when you use a single ' or " in each of the login fields?
You'll need to login as a specific user. If you're new to SQL syntax, this might be useful resource for understanding the intended query and how you can manipulate it for your purposes.

## Notes
Enter a single quote (') in the username and password fields gives the following:
'''
SELECT username FROM users WHERE username = ''' AND pwHash = '265fda17a34611b1533d8a281ff680dc5791b0ce0a11c25b35e11c8e75685509'
'''

Looking at the 'pwHash', the hash is 64 characters long, which hints that it might be a sha256 hash. Using a sha256 tool to verify (https://xorbin.com/tools/sha256-hash-calculator), the sha256 hash of a single quote (') is:

265fda17a34611b1533d8a281ff680dc5791b0ce0a11c25b35e11c8e75685509

So the password field is definitely getting hashed. There is not much we can do with this field. However, the username field can be manipulated. Attempt to try the 1=1 trick:

username:
' or 1=1;--

password:
AnyString

That worked. The website displays:

Welcome admin! The "hash" for account 'houdini' is 'Not a hash'.

It gives us the username: houdini. Now to hack houdini:

username:
houdini';--

password:
AnyString

Result:
Welcome Houdini, here's your flag: ACI{fd35465a027eeee3be0249d9f86}

## Acknowledgements

The format of these write-ups are all based off of [archang31](https://github.com/archang31/aacs4-writeups/)'s very organized repo. Thank you for sharing, Archang31!